<html lang="en"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PRISM.node2 - Control Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&amp;family=Nunito:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap');

    :root {
      --font-size: 16px;
      --prism-bg-canvas: #1c2130;
      --prism-bg-surface: #252d3f;
      --prism-bg-elevated: #2f3849;
      --prism-text-primary: #e6e9ef;
      --prism-text-secondary: #b5bdca;
      --prism-gold: #ffb84d;
      --prism-success: #22dd88;
      --prism-warning: #f59e0b;
      --prism-error: #ef4444;
      --prism-info: #6ee7f3;
      --prism-scalar: #f59e0b;
      --prism-field: #22d3ee;
      --prism-color: #f472b6;
      --prism-output: #34d399;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Nunito', -apple-system, BlinkMacSystemFont, sans-serif;
      background-color: var(--prism-bg-canvas);
      color: var(--prism-text-primary);
      font-size: var(--font-size);
      overflow: hidden;
    }

    .font-jetbrains {
      font-family: 'JetBrains Mono', 'Courier New', monospace;
    }

    .tracking-tighter {
      letter-spacing: -0.05em;
    }

    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
    }

    input[type="range"]::-webkit-slider-track {
      background-color: rgba(181, 189, 202, 0.2);
      height: 4px;
      border-radius: 2px;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      background-color: var(--prism-gold);
      height: 16px;
      width: 16px;
      border-radius: 50%;
      margin-top: -6px;
      transition: transform 120ms ease-out;
    }

    input[type="range"]::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    input[type="range"]::-moz-range-track {
      background-color: rgba(181, 189, 202, 0.2);
      height: 4px;
      border-radius: 2px;
    }

    input[type="range"]::-moz-range-thumb {
      background-color: var(--prism-gold);
      height: 16px;
      width: 16px;
      border-radius: 50%;
      border: none;
      transition: transform 120ms ease-out;
    }

    input[type="range"]::-moz-range-thumb:hover {
      transform: scale(1.1);
    }

    .view-hidden {
      display: none;
    }

    .view-active {
      display: flex;
    }

    .node-port {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 2px solid var(--prism-bg-elevated);
      transition: all 120ms ease-out;
    }

    .node-port:hover {
      transform: scale(1.2);
    }

    .grid-pattern {
      background-image: 
        linear-gradient(rgba(181, 189, 202, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(181, 189, 202, 0.05) 1px, transparent 1px);
      background-size: 20px 20px;
    }

    .scrollbar-custom::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .scrollbar-custom::-webkit-scrollbar-track {
      background: transparent;
    }

    .scrollbar-custom::-webkit-scrollbar-thumb {
      background: rgba(181, 189, 202, 0.2);
      border-radius: 4px;
    }

    .scrollbar-custom::-webkit-scrollbar-thumb:hover {
      background: rgba(181, 189, 202, 0.3);
    }
  </style>
</head>
<body class="dark">

  <!-- Main Container -->
  <div style="display: flex; height: 100vh; background-color: var(--prism-bg-canvas);">
    
    <!-- Sidebar -->
    <div id="sidebar" style="width: 280px; background-color: var(--prism-bg-surface); border-right: 1px solid rgba(181, 189, 202, 0.1); display: flex; flex-direction: column; transition: transform 180ms ease-out;">
      
      <!-- Logo -->
      <div style="padding: 24px 20px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
        <div style="font-size: 24px; font-weight: 700; letter-spacing: -0.02em; color: var(--prism-gold);">
          PRISM<span style="color: var(--prism-text-secondary); font-weight: 400;">.node2</span>
        </div>
        <div style="font-size: 12px; color: var(--prism-text-secondary); margin-top: 4px;">
          Unified Control Dashboard
        </div>
      </div>

      <!-- Connection Status -->
      <div style="padding: 20px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
        <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.05em;">
          Device Connection
        </div>
        
        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
          <div id="connectionStatus" style="width: 8px; height: 8px; border-radius: 50%; background-color: var(--prism-error);"></div>
          <span id="connectionText" style="font-size: 13px; color: var(--prism-text-secondary);">Disconnected</span>
        </div>

        <input type="text" id="deviceIP" placeholder="192.168.1.100" style="width: 100%; padding: 8px 12px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 13px; margin-bottom: 8px; outline: none; transition: border-color 120ms ease-out;" value="192.168.1.100">

        <select id="serialSelect" style="width: 100%; padding: 8px 12px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 13px; margin-bottom: 12px; outline: none; cursor: pointer;">
          <option>Serial 01</option>
          <option>Serial 02</option>
          <option>Serial 03</option>
        </select>

        <button id="connectBtn" style="width: 100%; padding: 10px; background-color: var(--prism-gold); color: #1c2130; border: none; border-radius: 6px; font-weight: 600; font-size: 14px; cursor: pointer; transition: all 120ms ease-out;">
          Connect
        </button>
      </div>

      <!-- Navigation -->
      <nav style="flex: 1; padding: 20px 0; overflow-y: auto;" class="scrollbar-custom">
        <div style="padding: 0 20px;">
          <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary); margin-bottom: 12px; text-transform: uppercase; letter-spacing: 0.05em;">
            Navigation
          </div>
        </div>
        
        <button onclick="switchView('control')" class="nav-btn" data-view="control" style="width: 100%; padding: 12px 20px; background: transparent; border: none; color: var(--prism-text-primary); text-align: left; cursor: pointer; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; transition: background-color 120ms ease-out; border-left: 3px solid var(--prism-gold);">
          <i data-lucide="sliders" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
          Control Panel
        </button>
        
        <button onclick="switchView('profiling')" class="nav-btn" data-view="profiling" style="width: 100%; padding: 12px 20px; background: transparent; border: none; color: var(--prism-text-primary); text-align: left; cursor: pointer; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; transition: background-color 120ms ease-out; border-left: 3px solid transparent;">
          <i data-lucide="activity" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
          Profiling
        </button>
        
        <button onclick="switchView('terminal')" class="nav-btn" data-view="terminal" style="width: 100%; padding: 12px 20px; background: transparent; border: none; color: var(--prism-text-primary); text-align: left; cursor: pointer; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; transition: background-color 120ms ease-out; border-left: 3px solid transparent;">
          <i data-lucide="terminal" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
          Terminal
        </button>
        
        <button onclick="switchView('graph')" class="nav-btn" data-view="graph" style="width: 100%; padding: 12px 20px; background: transparent; border: none; color: var(--prism-text-primary); text-align: left; cursor: pointer; display: flex; align-items: center; gap: 12px; font-size: 14px; font-weight: 500; transition: background-color 120ms ease-out; border-left: 3px solid transparent;">
          <i data-lucide="network" style="width: 18px; height: 18px; stroke-width: 1.5;"></i>
          Graph Editor
        </button>
      </nav>

      <!-- Footer -->
      <div style="padding: 20px; border-top: 1px solid rgba(181, 189, 202, 0.1); font-size: 12px; color: var(--prism-text-secondary);">
        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
          <span>Version 2.1.0</span>
          <button onclick="showShortcuts()" style="background: none; border: none; color: var(--prism-info); cursor: pointer; font-size: 12px; padding: 0;">
            Shortcuts ?
          </button>
        </div>
        <div style="opacity: 0.6;">© 2024 PRISM.node</div>
      </div>
    </div>

    <!-- Main Content -->
    <div style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
      
      <!-- Top Navigation Bar -->
      <div style="height: 64px; background-color: var(--prism-bg-surface); border-bottom: 1px solid rgba(181, 189, 202, 0.1); display: flex; align-items: center; justify-content: space-between; padding: 0 24px;">
        
        <div style="display: flex; align-items: center; gap: 16px;">
          <button id="sidebarToggle" style="background: none; border: none; color: var(--prism-text-secondary); cursor: pointer; padding: 8px; display: none;">
            <i data-lucide="menu" style="width: 20px; height: 20px; stroke-width: 1.5;"></i>
          </button>
          <h1 id="viewTitle" style="font-size: 20px; font-weight: 600; color: var(--prism-text-primary); letter-spacing: -0.02em;">Control Panel</h1>
        </div>

        <div style="display: flex; align-items: center; gap: 16px;">
          <!-- Audio Reactivity Pill -->
          <div id="audioReactivityPill" style="display: flex; align-items: center; gap: 8px; padding: 6px 12px; background-color: var(--prism-bg-elevated); border-radius: 20px; cursor: pointer; transition: background-color 120ms ease-out;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background-color: var(--prism-success);"></div>
            <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Audio: On</span>
          </div>

          <!-- Connection Badge -->
          <div id="topConnectionBadge" style="display: flex; align-items: center; gap: 8px; padding: 6px 12px; background-color: rgba(239, 68, 68, 0.1); border-radius: 6px;">
            <div style="width: 6px; height: 6px; border-radius: 50%; background-color: var(--prism-error);"></div>
            <span style="font-size: 12px; font-weight: 600; color: var(--prism-error);">Disconnected</span>
          </div>
        </div>
      </div>

      <!-- Views Container -->
      <div style="flex: 1; overflow: hidden; position: relative;">
        
        <!-- Control Panel View -->
        <div id="controlView" class="view-active" style="flex-direction: column; height: 100%; overflow-y: auto;">
          
          <div style="padding: 24px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; max-width: 1800px; margin: 0 auto; width: 100%;">
            
            <!-- Left Column: Effect Selection -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
              
              <!-- Effect Selector -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                  <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary);">Effect Selection</h2>
                  <span style="font-size: 12px; color: var(--prism-text-secondary);">9 effects</span>
                </div>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                  <button onclick="selectEffect('Analog', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid var(--prism-gold); border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out; position: relative;">
                    <i data-lucide="waves" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-gold);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Analog</span>
                    <div style="position: absolute; top: 6px; right: 6px; width: 6px; height: 6px; border-radius: 50%; background-color: var(--prism-gold);"></div>
                  </button>
                  
                  <button onclick="selectEffect('Spectrum', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="bar-chart-3" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Spectrum</span>
                  </button>
                  
                  <button onclick="selectEffect('Octave', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="layers" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Octave</span>
                  </button>
                  
                  <button onclick="selectEffect('Metronome', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="clock" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 11px; font-weight: 600; color: var(--prism-text-primary);">Metronome</span>
                  </button>
                  
                  <button onclick="selectEffect('Spectronome', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="radio" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 11px; font-weight: 600; color: var(--prism-text-primary);">Spectronome</span>
                  </button>
                  
                  <button onclick="selectEffect('Hype', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="zap" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Hype</span>
                  </button>
                  
                  <button onclick="selectEffect('Bloom', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="flower" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">Bloom</span>
                  </button>
                  
                  <button onclick="selectEffect('PULSE', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="circle-dot" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">PULSE</span>
                  </button>
                  
                  <button onclick="selectEffect('SPARKLE', this)" class="effect-btn" style="aspect-ratio: 1; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 10px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 6px; transition: all 120ms ease-out;">
                    <i data-lucide="sparkles" style="width: 24px; height: 24px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                    <span style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary);">SPARKLE</span>
                  </button>
                </div>

                <div style="margin-top: 16px; padding: 12px; background-color: var(--prism-bg-canvas); border-radius: 8px; display: flex; align-items: center; gap: 12px;">
                  <i data-lucide="info" style="width: 16px; height: 16px; stroke-width: 1.5; color: var(--prism-info);"></i>
                  <span style="font-size: 12px; color: var(--prism-text-secondary);">Active: <strong style="color: var(--prism-gold);">Analog</strong> (Audio-Reactive)</span>
                </div>
              </div>

              <!-- Mode Selectors -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Mode Settings</h2>

                <!-- Void Trail -->
                <div style="margin-bottom: 20px;">
                  <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary); display: block; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Void Trail</label>
                  <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px;">
                    <button onclick="selectVoidTrail('Off', this)" class="void-btn" style="padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid var(--prism-gold); border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Off
                    </button>
                    <button onclick="selectVoidTrail('Short', this)" class="void-btn" style="padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Short
                    </button>
                    <button onclick="selectVoidTrail('Medium', this)" class="void-btn" style="padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Medium
                    </button>
                    <button onclick="selectVoidTrail('Long', this)" class="void-btn" style="padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Long
                    </button>
                  </div>
                </div>

                <!-- Audio Reactivity -->
                <div>
                  <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary); display: block; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Audio Reactivity</label>
                  <div style="display: flex; gap: 8px;">
                    <button onclick="selectAudioMode('On', this)" class="audio-btn" style="flex: 1; padding: 10px; background-color: rgba(34, 221, 136, 0.2); border: 2px solid var(--prism-success); border-radius: 6px; color: var(--prism-success); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      On
                    </button>
                    <button onclick="selectAudioMode('Off', this)" class="audio-btn" style="flex: 1; padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Off
                    </button>
                    <button onclick="selectAudioMode('Clipping', this)" class="audio-btn" style="flex: 1; padding: 10px; background-color: var(--prism-bg-elevated); border: 2px solid transparent; border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; font-weight: 600; cursor: pointer; transition: all 120ms ease-out;">
                      Clipping
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Middle Column: Parameters & Colors -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
              
              <!-- Effect Parameters -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                  <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary);">Effect Parameters</h2>
                  <span id="syncingIndicator" style="font-size: 11px; color: var(--prism-info); font-weight: 600; opacity: 0; transition: opacity 180ms ease-out;">Syncing…</span>
                </div>

                <div style="display: flex; flex-direction: column; gap: 20px;">
                  
                  <!-- Frequency Range -->
                  <div>
                    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Frequency Range</label>
                      <span id="freqValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">20Hz - 2kHz</span>
                    </div>
                    <input type="range" min="20" max="20000" value="2000" oninput="updateParam('freq', this.value)" style="width: 100%;">
                  </div>

                  <!-- Sensitivity -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Sensitivity</label>
                      <span id="sensitivityValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">75%</span>
                    </div>
                    <input type="range" min="0" max="100" value="75" oninput="updateParam('sensitivity', this.value)" style="width: 100%;">
                  </div>

                  <!-- Decay -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Decay</label>
                      <span id="decayValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">500ms</span>
                    </div>
                    <input type="range" min="0" max="2000" value="500" oninput="updateParam('decay', this.value)" style="width: 100%;">
                  </div>

                  <!-- Wave Type -->
                  <div>
                    <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary); display: block; margin-bottom: 8px;">Wave Type</label>
                    <select style="width: 100%; padding: 10px 12px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 13px; cursor: pointer; outline: none;">
                      <option>Sine</option>
                      <option>Square</option>
                      <option>Triangle</option>
                      <option>Sawtooth</option>
                    </select>
                  </div>

                  <!-- Smoothing -->
                  <div>
                    <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary); display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
                      <input type="checkbox" checked="" style="width: 16px; height: 16px; cursor: pointer;">
                      Enable Smoothing
                    </label>
                    <span style="font-size: 11px; color: var(--prism-text-secondary); opacity: 0.8;">Reduces jitter in audio response</span>
                  </div>
                </div>
              </div>

              <!-- Color Management -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Color Palette</h2>

                <!-- Preset Palettes -->
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 20px;">
                  <button onclick="selectPalette('Fire', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #ff0000, #ff6600, #ffaa00); border: 2px solid var(--prism-gold); border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Fire</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Ocean', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #0066cc, #00aaff, #66ffff); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Ocean</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Forest', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #004400, #00aa00, #88ff88); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Forest</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Sunset', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #ff0066, #ff6600, #ffdd00); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Sunset</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Purple', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #6600cc, #aa00ff, #ff00ff); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Purple</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Ice', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #0088ff, #00ccff, #ffffff); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Ice</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Neon', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #00ff00, #00ffff, #ff00ff); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Neon</span>
                    </div>
                  </button>
                  <button onclick="selectPalette('Mono', this)" class="palette-btn" style="aspect-ratio: 1; background: linear-gradient(135deg, #000000, #888888, #ffffff); border: 2px solid transparent; border-radius: 8px; cursor: pointer; transition: all 120ms ease-out; position: relative;">
                    <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; background: rgba(0,0,0,0.3); border-radius: 6px; opacity: 0; transition: opacity 120ms ease-out;">
                      <span style="font-size: 10px; color: white; font-weight: 600;">Mono</span>
                    </div>
                  </button>
                </div>

                <!-- Live Gradient Preview -->
                <div style="height: 60px; background: linear-gradient(90deg, #ff0000, #ff6600, #ffaa00); border-radius: 8px; margin-bottom: 16px; border: 1px solid rgba(181, 189, 202, 0.2);"></div>

                <!-- HSV Sliders -->
                <div style="display: flex; flex-direction: column; gap: 16px;">
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                      <label style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary);">Hue</label>
                      <span style="font-size: 11px; color: var(--prism-gold);">180°</span>
                    </div>
                    <input type="range" min="0" max="360" value="180" style="width: 100%;">
                  </div>
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                      <label style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary);">Saturation</label>
                      <span style="font-size: 11px; color: var(--prism-gold);">85%</span>
                    </div>
                    <input type="range" min="0" max="100" value="85" style="width: 100%;">
                  </div>
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                      <label style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary);">Value</label>
                      <span style="font-size: 11px; color: var(--prism-gold);">90%</span>
                    </div>
                    <input type="range" min="0" max="100" value="90" style="width: 100%;">
                  </div>
                </div>

                <button style="width: 100%; padding: 10px; margin-top: 16px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 120ms ease-out;">
                  <i data-lucide="copy" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                  Copy Hex Colors
                </button>
              </div>
            </div>

            <!-- Right Column: Global Settings -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
              
              <!-- Global Settings -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Global Settings</h2>

                <div style="display: flex; flex-direction: column; gap: 20px;">
                  
                  <!-- Brightness -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Brightness</label>
                      <span id="brightnessValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">80%</span>
                    </div>
                    <input type="range" min="0" max="100" value="80" oninput="updateGlobal('brightness', this.value)" style="width: 100%;">
                  </div>

                  <!-- Blur -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Blur</label>
                      <span id="blurValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">2px</span>
                    </div>
                    <input type="range" min="0" max="10" value="2" oninput="updateGlobal('blur', this.value)" style="width: 100%;">
                  </div>

                  <!-- Softness -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Softness</label>
                      <span id="softnessValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">50%</span>
                    </div>
                    <input type="range" min="0" max="100" value="50" oninput="updateGlobal('softness', this.value)" style="width: 100%;">
                  </div>

                  <!-- Gamma Correction -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Gamma Correction</label>
                      <span id="gammaValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">2.2</span>
                    </div>
                    <input type="range" min="10" max="30" value="22" oninput="updateGlobal('gamma', this.value)" style="width: 100%;">
                    <div style="margin-top: 8px; height: 40px; background: linear-gradient(90deg, rgba(0,0,0,0.9), rgba(255,255,255,0.9)); border-radius: 6px; border: 1px solid rgba(181, 189, 202, 0.1); position: relative;">
                      <div style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 2px; height: 100%; background-color: var(--prism-gold); opacity: 0.5;"></div>
                    </div>
                  </div>

                  <!-- Warmth -->
                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                      <label style="font-size: 13px; font-weight: 600; color: var(--prism-text-secondary);">Warmth</label>
                      <span id="warmthValue" style="font-size: 12px; color: var(--prism-gold); font-weight: 600;">5500K</span>
                    </div>
                    <input type="range" min="2000" max="10000" value="5500" oninput="updateGlobal('warmth', this.value)" style="width: 100%;">
                    <div style="margin-top: 8px; height: 20px; background: linear-gradient(90deg, #ff8800, #ffffff, #88aaff); border-radius: 6px; border: 1px solid rgba(181, 189, 202, 0.1);"></div>
                  </div>
                </div>
              </div>

              <!-- Quick Actions -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Quick Actions</h2>

                <div style="display: flex; flex-direction: column; gap: 10px;">
                  <button onclick="showResetConfirm()" style="width: 100%; padding: 12px; background-color: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 6px; color: var(--prism-error); font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 120ms ease-out;">
                    <i data-lucide="rotate-ccw" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                    Reset All Parameters
                  </button>
                  
                  <button style="width: 100%; padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 120ms ease-out;">
                    <i data-lucide="save" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                    Save Preset
                  </button>
                  
                  <button style="width: 100%; padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; transition: all 120ms ease-out;">
                    <i data-lucide="upload" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                    Load Preset
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Status Bar -->
          <div style="position: sticky; bottom: 0; left: 0; right: 0; height: 48px; background-color: var(--prism-bg-surface); border-top: 1px solid rgba(181, 189, 202, 0.1); display: flex; align-items: center; justify-content: space-between; padding: 0 24px;">
            <div style="display: flex; align-items: center; gap: 24px;">
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 12px; color: var(--prism-text-secondary);">FPS:</span>
                <span id="fpsDisplay" style="font-size: 12px; font-weight: 600; color: var(--prism-success);">60</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 12px; color: var(--prism-text-secondary);">Frame Time:</span>
                <span id="frameTimeDisplay" style="font-size: 12px; font-weight: 600; color: var(--prism-success);">16.7ms</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 12px; color: var(--prism-text-secondary);">CPU:</span>
                <span id="cpuDisplay" style="font-size: 12px; font-weight: 600; color: var(--prism-success);">250μs</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 12px; color: var(--prism-text-secondary);">Memory:</span>
                <span id="memoryDisplay" style="font-size: 12px; font-weight: 600; color: var(--prism-success);">62%</span>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
              <i data-lucide="headphones" style="width: 14px; height: 14px; stroke-width: 1.5; color: var(--prism-success);"></i>
              <span style="font-size: 12px; color: var(--prism-text-secondary);">Audio Device: <strong style="color: var(--prism-text-primary);">Default</strong></span>
            </div>
          </div>
        </div>

        <!-- Profiling View -->
        <div id="profilingView" class="view-hidden" style="flex-direction: column; height: 100%; overflow-y: auto;">
          
          <div style="padding: 24px; display: grid; grid-template-columns: 1fr 320px; gap: 24px; max-width: 1800px; margin: 0 auto; width: 100%;">
            
            <!-- Charts Column -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
              
              <!-- Filters -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 16px; display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <label style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary);">Effect:</label>
                  <select style="padding: 6px 10px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; cursor: pointer;">
                    <option>All Effects</option>
                    <option>Analog</option>
                    <option>Spectrum</option>
                    <option>Octave</option>
                  </select>
                </div>
                
                <div style="display: flex; align-items: center; gap: 8px;">
                  <label style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary);">Time Range:</label>
                  <select style="padding: 6px 10px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 12px; cursor: pointer;">
                    <option>Last 100 frames</option>
                    <option>Last 500 frames</option>
                    <option>Last 1000 frames</option>
                  </select>
                </div>

                <div style="display: flex; align-items: center; gap: 8px; margin-left: auto;">
                  <button style="padding: 6px 12px; background-color: var(--prism-gold); color: #1c2130; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                    <i data-lucide="download" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                    Export CSV
                  </button>
                </div>
              </div>

              <!-- FPS Chart -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">FPS Over Time</h3>
                <div style="height: 200px; background-color: var(--prism-bg-canvas); border-radius: 8px; position: relative; padding: 16px;">
                  <!-- Simulated Chart -->
                  <svg width="100%" height="100%" style="position: absolute; inset: 16px;">
                    <line x1="0" y1="50%" x2="100%" y2="50%" stroke="var(--prism-text-secondary)" stroke-width="1" stroke-dasharray="4" opacity="0.3"></line>
                    <polyline points="0,140 50,130 100,145 150,125 200,135 250,120 300,130 350,125 400,135 450,130 500,140 550,125 600,130" fill="none" stroke="var(--prism-success)" stroke-width="2"></polyline>
                    <text x="10" y="20" fill="var(--prism-text-secondary)" font-size="11">60 FPS</text>
                    <text x="10" y="90" fill="var(--prism-text-secondary)" font-size="11">30 FPS</text>
                  </svg>
                </div>
                <div style="display: flex; gap: 16px; margin-top: 12px; font-size: 11px;">
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 3px; background-color: var(--prism-success); border-radius: 2px;"></div>
                    <span style="color: var(--prism-text-secondary);">Current FPS</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 1px; background-color: var(--prism-text-secondary); opacity: 0.3;"></div>
                    <span style="color: var(--prism-text-secondary);">Target (60)</span>
                  </div>
                </div>
              </div>

              <!-- Frame Time Breakdown -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Frame Time Breakdown</h3>
                <div style="height: 200px; background-color: var(--prism-bg-canvas); border-radius: 8px; position: relative; padding: 16px;">
                  <!-- Stacked Area Chart Simulation -->
                  <svg width="100%" height="100%" style="position: absolute; inset: 16px;">
                    <defs>
                      <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color: var(--prism-warning); stop-opacity: 0.5"></stop>
                        <stop offset="100%" style="stop-color: var(--prism-warning); stop-opacity: 0.1"></stop>
                      </linearGradient>
                      <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color: var(--prism-info); stop-opacity: 0.5"></stop>
                        <stop offset="100%" style="stop-color: var(--prism-info); stop-opacity: 0.1"></stop>
                      </linearGradient>
                    </defs>
                    <polygon points="0,160 600,160 600,120 550,115 500,125 450,118 400,130 350,120 300,135 250,125 200,130 150,122 100,128 50,125 0,130" fill="url(#grad1)"></polygon>
                    <polygon points="0,130 50,125 100,128 150,122 200,130 250,125 300,135 350,120 400,130 450,118 500,125 550,115 600,120 600,80 550,75 500,85 450,78 400,90 350,80 300,95 250,85 200,90 150,82 100,88 50,85 0,90" fill="url(#grad2)"></polygon>
                  </svg>
                </div>
                <div style="display: flex; gap: 16px; margin-top: 12px; font-size: 11px; flex-wrap: wrap;">
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 12px; background-color: var(--prism-warning); opacity: 0.5; border-radius: 2px;"></div>
                    <span style="color: var(--prism-text-secondary);">Effect (8ms)</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 12px; background-color: var(--prism-info); opacity: 0.5; border-radius: 2px;"></div>
                    <span style="color: var(--prism-text-secondary);">GPU (5ms)</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 12px; background-color: var(--prism-success); opacity: 0.5; border-radius: 2px;"></div>
                    <span style="color: var(--prism-text-secondary);">Driver (2ms)</span>
                  </div>
                  <div style="display: flex; align-items: center; gap: 6px;">
                    <div style="width: 12px; height: 12px; background-color: var(--prism-text-secondary); opacity: 0.3; border-radius: 2px;"></div>
                    <span style="color: var(--prism-text-secondary);">Other (1.7ms)</span>
                  </div>
                </div>
              </div>

              <!-- CPU by Effect -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">CPU Usage by Effect</h3>
                <div style="height: 240px; background-color: var(--prism-bg-canvas); border-radius: 8px; padding: 16px; display: flex; align-items: flex-end; gap: 12px;">
                  <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px;">
                    <div style="width: 100%; height: 180px; background: linear-gradient(to top, var(--prism-gold), rgba(255, 184, 77, 0.3)); border-radius: 6px 6px 0 0; position: relative;">
                      <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px; font-weight: 600; color: var(--prism-gold);">320μs</span>
                    </div>
                    <span style="font-size: 11px; color: var(--prism-text-secondary);">Analog</span>
                  </div>
                  <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px;">
                    <div style="width: 100%; height: 140px; background: linear-gradient(to top, var(--prism-info), rgba(110, 231, 243, 0.3)); border-radius: 6px 6px 0 0; position: relative;">
                      <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px; font-weight: 600; color: var(--prism-info);">250μs</span>
                    </div>
                    <span style="font-size: 11px; color: var(--prism-text-secondary);">Spectrum</span>
                  </div>
                  <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px;">
                    <div style="width: 100%; height: 100px; background: linear-gradient(to top, var(--prism-success), rgba(34, 221, 136, 0.3)); border-radius: 6px 6px 0 0; position: relative;">
                      <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px; font-weight: 600; color: var(--prism-success);">180μs</span>
                    </div>
                    <span style="font-size: 11px; color: var(--prism-text-secondary);">PULSE</span>
                  </div>
                  <div style="flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px;">
                    <div style="width: 100%; height: 160px; background: linear-gradient(to top, var(--prism-warning), rgba(245, 158, 11, 0.3)); border-radius: 6px 6px 0 0; position: relative;">
                      <span style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 11px; font-weight: 600; color: var(--prism-warning);">290μs</span>
                    </div>
                    <span style="font-size: 11px; color: var(--prism-text-secondary);">Bloom</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Statistics Column -->
            <div style="display: flex; flex-direction: column; gap: 24px;">
              
              <!-- Live Statistics -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Live Statistics</h3>
                
                <div style="display: flex; flex-direction: column; gap: 16px;">
                  
                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Avg FPS</span>
                      <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">58.4</span>
                        <i data-lucide="arrow-up" style="width: 12px; height: 12px; stroke-width: 2; color: var(--prism-success);"></i>
                      </div>
                    </div>
                    <div style="font-size: 10px; color: var(--prism-success);">+2.1 from previous</div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Min FPS</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-warning);">52.1</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Max FPS</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">64.8</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Avg Frame Time</span>
                      <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">17.1ms</span>
                        <i data-lucide="arrow-down" style="width: 12px; height: 12px; stroke-width: 2; color: var(--prism-success);"></i>
                      </div>
                    </div>
                    <div style="font-size: 10px; color: var(--prism-success);">-0.6ms improvement</div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">CPU Usage</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">265μs</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Memory Usage</span>
                      <div style="display: flex; align-items: center; gap: 6px;">
                        <span style="font-size: 14px; font-weight: 600; color: var(--prism-warning);">68.2%</span>
                        <i data-lucide="arrow-up" style="width: 12px; height: 12px; stroke-width: 2; color: var(--prism-warning);"></i>
                      </div>
                    </div>
                    <div style="font-size: 10px; color: var(--prism-warning);">+3.1% increase</div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">GPU Time</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">4.8ms</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Driver Overhead</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">2.1ms</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Buffer Swaps</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">3,421</span>
                    </div>
                  </div>

                  <div style="padding-bottom: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Dropped Frames</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-success);">0</span>
                    </div>
                  </div>

                  <div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
                      <span style="font-size: 12px; color: var(--prism-text-secondary);">Effect Changes</span>
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">12</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- System Info -->
              <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">System Info</h3>
                
                <div style="display: flex; flex-direction: column; gap: 12px; font-size: 12px;">
                  <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--prism-text-secondary);">Device</span>
                    <span style="color: var(--prism-text-primary); font-weight: 500;">PRISM.node v2</span>
                  </div>
                  <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--prism-text-secondary);">Firmware</span>
                    <span style="color: var(--prism-text-primary); font-weight: 500;">2.1.0</span>
                  </div>
                  <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--prism-text-secondary);">LED Count</span>
                    <span style="color: var(--prism-text-primary); font-weight: 500;">300</span>
                  </div>
                  <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--prism-text-secondary);">Audio Input</span>
                    <span style="color: var(--prism-text-primary); font-weight: 500;">Line In</span>
                  </div>
                  <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--prism-text-secondary);">Uptime</span>
                    <span style="color: var(--prism-text-primary); font-weight: 500;">2h 34m</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Terminal View -->
        <div id="terminalView" class="view-hidden" style="flex-direction: column; height: 100%; padding: 24px; gap: 24px;">
          
          <div style="max-width: 1200px; margin: 0 auto; width: 100%; display: flex; flex-direction: column; gap: 24px; height: 100%;">
            
            <!-- Terminal Output -->
            <div style="flex: 1; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px; display: flex; flex-direction: column; overflow: hidden;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary);">Terminal Output</h2>
                <button onclick="clearTerminal()" style="padding: 6px 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                  <i data-lucide="trash-2" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                  Clear
                </button>
              </div>
              
              <div id="terminalOutput" style="flex: 1; background-color: #0d1117; border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; padding: 16px; overflow-y: auto; font-family: 'JetBrains Mono', monospace; font-size: 13px; line-height: 1.6;" class="scrollbar-custom font-jetbrains">
                <div style="color: var(--prism-success);">PRISM.node2 Terminal v2.1.0</div>
                <div style="color: var(--prism-text-secondary); margin-top: 4px;">Type 'help' for available commands</div>
                <div style="color: var(--prism-text-secondary); margin-bottom: 16px;">───────────────────────────────────────</div>
              </div>
            </div>

            <!-- Command Input -->
            <div style="background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px; padding: 20px;">
              <h2 style="font-size: 16px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 16px;">Execute Command</h2>
              
              <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <input type="text" id="terminalInput" placeholder="Enter command..." style="flex: 1; padding: 10px 12px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 14px; outline: none; font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">
                <button onclick="executeCommand()" style="padding: 10px 20px; background-color: var(--prism-gold); color: #1c2130; border: none; border-radius: 6px; font-weight: 600; font-size: 14px; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                  <i data-lucide="play" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                  Execute
                </button>
              </div>

              <!-- Command History -->
              <div style="margin-bottom: 16px;">
                <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Command History</div>
                <div id="commandHistory" style="display: flex; flex-wrap: wrap; gap: 8px;">
                  <button onclick="fillCommand('help')" style="padding: 6px 10px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 11px; cursor: pointer; font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">help</button>
                  <button onclick="fillCommand('p')" style="padding: 6px 10px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 11px; cursor: pointer; font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">p</button>
                </div>
              </div>

              <!-- Available Commands -->
              <div>
                <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-secondary); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;">Available Commands</div>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; font-size: 11px; color: var(--prism-text-secondary); font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">
                  <div><span style="color: var(--prism-gold);">p</span> - Play</div>
                  <div><span style="color: var(--prism-gold);">k</span> - Kill</div>
                  <div><span style="color: var(--prism-gold);">v</span> - Version</div>
                  <div><span style="color: var(--prism-gold);">j</span> - Jump</div>
                  <div><span style="color: var(--prism-gold);">r</span> - Reset</div>
                  <div><span style="color: var(--prism-gold);">c</span> - Config</div>
                  <div><span style="color: var(--prism-gold);">s</span> - Status</div>
                  <div><span style="color: var(--prism-gold);">help</span> - Help</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Graph Editor View -->
        <div id="graphView" class="view-hidden" style="flex-direction: column; height: 100%; overflow: hidden;">
          
          <!-- Graph Toolbar -->
          <div style="height: 56px; background-color: var(--prism-bg-surface); border-bottom: 1px solid rgba(181, 189, 202, 0.1); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; gap: 16px;">
            
            <!-- Left Tools -->
            <div style="display: flex; align-items: center; gap: 12px;">
              <button onclick="graphUndo()" id="undoBtn" disabled="" style="padding: 8px 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; opacity: 0.5;">
                <i data-lucide="undo-2" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                Undo
              </button>
              
              <button onclick="graphRedo()" id="redoBtn" disabled="" style="padding: 8px 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; opacity: 0.5;">
                <i data-lucide="redo-2" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                Redo
              </button>

              <div style="width: 1px; height: 24px; background-color: rgba(181, 189, 202, 0.2);"></div>

              <!-- Zoom Controls -->
              <div style="display: flex; align-items: center; gap: 4px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; padding: 4px;">
                <button onclick="zoomIn()" style="padding: 4px 8px; background: transparent; border: none; color: var(--prism-text-secondary); cursor: pointer;">
                  <i data-lucide="zoom-in" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                </button>
                <span id="zoomLevel" style="font-size: 12px; color: var(--prism-text-primary); font-weight: 600; min-width: 45px; text-align: center;">100%</span>
                <button onclick="zoomOut()" style="padding: 4px 8px; background: transparent; border: none; color: var(--prism-text-secondary); cursor: pointer;">
                  <i data-lucide="zoom-out" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                </button>
                <div style="width: 1px; height: 20px; background-color: rgba(181, 189, 202, 0.2); margin: 0 4px;"></div>
                <button onclick="fitToView()" style="padding: 4px 8px; background: transparent; border: none; color: var(--prism-text-secondary); cursor: pointer; font-size: 11px; font-weight: 600;">
                  Fit
                </button>
              </div>

              <button onclick="toggleGrid()" id="gridToggle" style="padding: 8px 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                <i data-lucide="grid-3x3" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
              </button>
            </div>

            <!-- Center Info -->
            <div style="flex: 1; text-align: center;">
              <span style="font-size: 13px; color: var(--prism-text-secondary);">Press <kbd style="padding: 2px 6px; background-color: var(--prism-bg-elevated); border-radius: 4px; font-family: 'JetBrains Mono', monospace; font-size: 11px;">/</kbd> to add nodes</span>
            </div>

            <!-- Right Tools -->
            <div style="display: flex; align-items: center; gap: 12px;">
              <button onclick="importGraph()" style="padding: 8px 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                <i data-lucide="upload" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                Import
              </button>
              
              <button onclick="exportGraph()" style="padding: 8px 12px; background-color: var(--prism-gold); color: #1c2130; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                <i data-lucide="download" style="width: 14px; height: 14px; stroke-width: 1.5;"></i>
                Export
              </button>
            </div>
          </div>

          <!-- Graph Canvas Container -->
          <div style="flex: 1; display: flex; overflow: hidden; position: relative;">
            
            <!-- Canvas -->
            <div id="graphCanvas" class="grid-pattern" style="flex: 1; position: relative; overflow: hidden; background-color: var(--prism-bg-canvas); cursor: grab;">
              
              <!-- Empty State -->
              <div id="graphEmptyState" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; max-width: 400px;">
                <div style="width: 80px; height: 80px; border-radius: 50%; background-color: var(--prism-bg-surface); border: 2px solid rgba(181, 189, 202, 0.2); display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                  <i data-lucide="network" style="width: 36px; height: 36px; stroke-width: 1.5; color: var(--prism-text-secondary);"></i>
                </div>
                <h3 style="font-size: 18px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 8px;">Start Building Your Graph</h3>
                <p style="font-size: 14px; color: var(--prism-text-secondary); margin-bottom: 24px;">Press <kbd style="padding: 2px 8px; background-color: var(--prism-bg-surface); border-radius: 4px; font-family: 'JetBrains Mono', monospace; font-size: 12px; border: 1px solid rgba(181, 189, 202, 0.2);">/</kbd> to open the node palette or choose a template below</p>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                  <button onclick="loadTemplate('beginner')" style="padding: 16px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 8px; cursor: pointer; text-align: left; transition: all 120ms ease-out;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Beginner</span>
                      <span style="padding: 2px 6px; background-color: var(--prism-success); color: #1c2130; font-size: 10px; font-weight: 600; border-radius: 4px;">EASY</span>
                    </div>
                    <div style="font-size: 11px; color: var(--prism-text-secondary);">Simple 3-node audio reactive graph</div>
                  </button>
                  
                  <button onclick="loadTemplate('intermediate')" style="padding: 16px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 8px; cursor: pointer; text-align: left; transition: all 120ms ease-out;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                      <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Intermediate</span>
                      <span style="padding: 2px 6px; background-color: var(--prism-warning); color: #1c2130; font-size: 10px; font-weight: 600; border-radius: 4px;">MEDIUM</span>
                    </div>
                    <div style="font-size: 11px; color: var(--prism-text-secondary);">Complex 7-node multi-effect setup</div>
                  </button>
                </div>
              </div>

              <!-- Sample Nodes (hidden initially) -->
              <div id="graphNodes" style="display: none;">
                <!-- Node 1: Audio Input -->
                <div style="position: absolute; left: 100px; top: 150px; width: 200px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                  <div style="padding: 12px 16px; background-color: var(--prism-bg-elevated); border-bottom: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px 10px 0 0; display: flex; align-items: center; gap: 8px;">
                    <i data-lucide="mic" style="width: 16px; height: 16px; stroke-width: 1.5; color: var(--prism-info);"></i>
                    <span style="font-size: 13px; font-weight: 600; color: var(--prism-text-primary);">Audio Input</span>
                  </div>
                  <div style="padding: 16px;">
                    <div style="display: flex; align-items: center; justify-content: flex-end; gap: 8px; margin-bottom: 8px;">
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Signal</span>
                      <div class="node-port" style="background-color: var(--prism-field);"></div>
                    </div>
                    <div style="display: flex; align-items: center; justify-content: flex-end; gap: 8px;">
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">FFT</span>
                      <div class="node-port" style="background-color: var(--prism-field);"></div>
                    </div>
                  </div>
                </div>

                <!-- Node 2: Frequency Analyzer -->
                <div style="position: absolute; left: 400px; top: 150px; width: 220px; background-color: var(--prism-bg-surface); border: 2px solid var(--prism-gold); border-radius: 10px; box-shadow: 0 4px 16px rgba(255, 184, 77, 0.3);">
                  <div style="padding: 12px 16px; background-color: var(--prism-bg-elevated); border-bottom: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px 8px 0 0; display: flex; align-items: center; justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <i data-lucide="bar-chart-3" style="width: 16px; height: 16px; stroke-width: 1.5; color: var(--prism-warning);"></i>
                      <span style="font-size: 13px; font-weight: 600; color: var(--prism-text-primary);">Freq Analyzer</span>
                    </div>
                    <span style="padding: 2px 6px; background-color: rgba(245, 158, 11, 0.2); color: var(--prism-warning); font-size: 9px; font-weight: 600; border-radius: 4px;">MED</span>
                  </div>
                  <div style="padding: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                      <div class="node-port" style="background-color: var(--prism-field);"></div>
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Input</span>
                    </div>
                    <div style="padding: 10px; background-color: var(--prism-bg-canvas); border-radius: 6px; margin-bottom: 12px;">
                      <div style="font-size: 10px; color: var(--prism-text-secondary); margin-bottom: 4px;">Range</div>
                      <input type="range" min="0" max="100" value="60" style="width: 100%;">
                    </div>
                    <div style="display: flex; align-items: center; justify-content: flex-end; gap: 8px;">
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Bands</span>
                      <div class="node-port" style="background-color: var(--prism-field);"></div>
                    </div>
                  </div>
                </div>

                <!-- Node 3: Color Mapper -->
                <div style="position: absolute; left: 700px; top: 100px; width: 200px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                  <div style="padding: 12px 16px; background-color: var(--prism-bg-elevated); border-bottom: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px 10px 0 0; display: flex; align-items: center; gap: 8px;">
                    <i data-lucide="palette" style="width: 16px; height: 16px; stroke-width: 1.5; color: var(--prism-color);"></i>
                    <span style="font-size: 13px; font-weight: 600; color: var(--prism-text-primary);">Color Map</span>
                  </div>
                  <div style="padding: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                      <div class="node-port" style="background-color: var(--prism-field);"></div>
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Value</span>
                    </div>
                    <div style="height: 30px; background: linear-gradient(90deg, #ff0000, #ff6600, #ffaa00); border-radius: 6px; margin-bottom: 12px;"></div>
                    <div style="display: flex; align-items: center; justify-content: flex-end; gap: 8px;">
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Color</span>
                      <div class="node-port" style="background-color: var(--prism-color);"></div>
                    </div>
                  </div>
                </div>

                <!-- Node 4: LED Output -->
                <div style="position: absolute; left: 700px; top: 300px; width: 200px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                  <div style="padding: 12px 16px; background-color: var(--prism-bg-elevated); border-bottom: 1px solid rgba(181, 189, 202, 0.1); border-radius: 10px 10px 0 0; display: flex; align-items: center; gap: 8px;">
                    <i data-lucide="monitor" style="width: 16px; height: 16px; stroke-width: 1.5; color: var(--prism-output);"></i>
                    <span style="font-size: 13px; font-weight: 600; color: var(--prism-text-primary);">LED Output</span>
                  </div>
                  <div style="padding: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                      <div class="node-port" style="background-color: var(--prism-color);"></div>
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Color In</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                      <div class="node-port" style="background-color: var(--prism-scalar);"></div>
                      <span style="font-size: 11px; color: var(--prism-text-secondary);">Brightness</span>
                    </div>
                  </div>
                </div>

                <!-- Connection Lines -->
                <svg style="position: absolute; inset: 0; pointer-events: none;" width="100%" height="100%">
                  <path d="M 300 180 Q 350 180 400 180" stroke="var(--prism-field)" stroke-width="2" fill="none" opacity="0.6"></path>
                  <path d="M 620 180 Q 660 140 700 140" stroke="var(--prism-field)" stroke-width="2" fill="none" opacity="0.6"></path>
                  <path d="M 620 200 Q 660 300 700 335" stroke="var(--prism-field)" stroke-width="2" fill="none" opacity="0.6"></path>
                </svg>
              </div>
            </div>

            <!-- Error Panel (Right Side) -->
            <div id="errorPanel" style="width: 320px; background-color: var(--prism-bg-surface); border-left: 1px solid rgba(181, 189, 202, 0.1); display: none; flex-direction: column;">
              <div style="padding: 16px; border-bottom: 1px solid rgba(181, 189, 202, 0.1); display: flex; justify-content: space-between; align-items: center;">
                <h3 style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Errors (3)</h3>
                <button onclick="closeErrorPanel()" style="background: none; border: none; color: var(--prism-text-secondary); cursor: pointer; padding: 4px;">
                  <i data-lucide="x" style="width: 16px; height: 16px; stroke-width: 1.5;"></i>
                </button>
              </div>
              
              <div style="padding: 12px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
                <div style="display: flex; gap: 8px;">
                  <button style="padding: 4px 8px; background-color: rgba(239, 68, 68, 0.2); border: 1px solid var(--prism-error); border-radius: 4px; color: var(--prism-error); font-size: 11px; font-weight: 600; cursor: pointer;">Error (2)</button>
                  <button style="padding: 4px 8px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 4px; color: var(--prism-text-secondary); font-size: 11px; font-weight: 600; cursor: pointer;">Warning (1)</button>
                </div>
              </div>

              <div style="flex: 1; overflow-y: auto; padding: 12px;" class="scrollbar-custom">
                <div style="background-color: var(--prism-bg-elevated); border-left: 3px solid var(--prism-error); border-radius: 6px; padding: 12px; margin-bottom: 12px; cursor: pointer;">
                  <div style="display: flex; align-items: start; gap: 8px; margin-bottom: 6px;">
                    <i data-lucide="alert-circle" style="width: 14px; height: 14px; stroke-width: 1.5; color: var(--prism-error); flex-shrink: 0; margin-top: 2px;"></i>
                    <div style="flex: 1;">
                      <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 4px;">Missing Input Connection</div>
                      <div style="font-size: 11px; color: var(--prism-text-secondary); margin-bottom: 6px;">Node "Freq Analyzer" input port is not connected</div>
                      <div style="font-size: 10px; color: var(--prism-error); font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">Node ID: node_002</div>
                    </div>
                  </div>
                </div>

                <div style="background-color: var(--prism-bg-elevated); border-left: 3px solid var(--prism-error); border-radius: 6px; padding: 12px; margin-bottom: 12px; cursor: pointer;">
                  <div style="display: flex; align-items: start; gap: 8px; margin-bottom: 6px;">
                    <i data-lucide="alert-circle" style="width: 14px; height: 14px; stroke-width: 1.5; color: var(--prism-error); flex-shrink: 0; margin-top: 2px;"></i>
                    <div style="flex: 1;">
                      <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 4px;">Type Mismatch</div>
                      <div style="font-size: 11px; color: var(--prism-text-secondary); margin-bottom: 6px;">Cannot connect Scalar to Field input</div>
                      <div style="font-size: 10px; color: var(--prism-error); font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">Connection: node_003 → node_004</div>
                    </div>
                  </div>
                </div>

                <div style="background-color: var(--prism-bg-elevated); border-left: 3px solid var(--prism-warning); border-radius: 6px; padding: 12px; cursor: pointer;">
                  <div style="display: flex; align-items: start; gap: 8px; margin-bottom: 6px;">
                    <i data-lucide="alert-triangle" style="width: 14px; height: 14px; stroke-width: 1.5; color: var(--prism-warning); flex-shrink: 0; margin-top: 2px;"></i>
                    <div style="flex: 1;">
                      <div style="font-size: 12px; font-weight: 600; color: var(--prism-text-primary); margin-bottom: 4px;">High Complexity</div>
                      <div style="font-size: 11px; color: var(--prism-text-secondary); margin-bottom: 6px;">Node compute cost exceeds recommended threshold</div>
                      <div style="font-size: 10px; color: var(--prism-warning); font-family: 'JetBrains Mono', monospace;" class="font-jetbrains">Node: "Freq Analyzer" (cost: 85)</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->

  <!-- Node Palette Modal -->
  <div id="nodePaletteModal" style="display: none; position: fixed; inset: 0; background-color: rgba(0, 0, 0, 0.7); z-index: 1000; align-items: center; justify-content: center; padding: 24px;">
    <div style="width: 100%; max-width: 700px; max-height: 600px; background-color: var(--prism-bg-surface); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 14px; display: flex; flex-direction: column; box-shadow: 0 24px 48px rgba(0,0,0,0.5);">
      
      <!-- Header -->
      <div style="padding: 20px 24px; border-bottom: 1px solid rgba(181, 189, 202, 0.1); display: flex; justify-content: space-between; align-items: center;">
        <h2 style="font-size: 18px; font-weight: 600; color: var(--prism-text-primary);">Add Node</h2>
        <button onclick="closeNodePalette()" style="background: none; border: none; color: var(--prism-text-secondary); cursor: pointer; padding: 4px;">
          <i data-lucide="x" style="width: 20px; height: 20px; stroke-width: 1.5;"></i>
        </button>
      </div>

      <!-- Search -->
      <div style="padding: 16px 24px; border-bottom: 1px solid rgba(181, 189, 202, 0.1);">
        <input type="text" placeholder="Search nodes..." style="width: 100%; padding: 10px 12px; background-color: var(--prism-bg-canvas); border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-primary); font-size: 14px; outline: none;">
      </div>

      <!-- Category Tabs -->
      <div style="padding: 12px 24px; border-bottom: 1px solid rgba(181, 189, 202, 0.1); display: flex; gap: 8px; overflow-x: auto;" class="scrollbar-custom">
        <button style="padding: 6px 12px; background-color: var(--prism-gold); color: #1c2130; border: none; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">All</button>
        <button style="padding: 6px 12px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">Input</button>
        <button style="padding: 6px 12px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">Processing</button>
        <button style="padding: 6px 12px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">Color</button>
        <button style="padding: 6px 12px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">Output</button>
        <button style="padding: 6px 12px; background-color: transparent; border: 1px solid rgba(181, 189, 202, 0.2); border-radius: 6px; color: var(--prism-text-secondary); font-size: 12px; font-weight: 600; cursor: pointer; white-space: nowrap;">Utility</button>
      </div>

      <!-- Node List -->
      <div style="flex: 1; overflow-y: auto; padding: 16px 24px;" class="scrollbar-custom">
        
        <div onclick="addNode('Audio Input')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="mic" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-info);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Audio Input</span>
              <span style="padding: 2px 6px; background-color: rgba(34, 221, 136, 0.2); color: var(--prism-success); font-size: 9px; font-weight: 600; border-radius: 4px;">LOW</span>
            </div>
            <div style="font-size: 11px; color: var(--prism-text-secondary);">Captures audio signal from input device</div>
          </div>
        </div>

        <div onclick="addNode('Frequency Analyzer')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="bar-chart-3" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-warning);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Frequency Analyzer</span>
              <span style="padding: 2px 6px; background-color: rgba(245, 158, 11, 0.2); color: var(--prism-warning); font-size: 9px; font-weight: 600; border-radius: 4px;">MED</span>
            </div>
            <div style="font-size: 11px; color: var(--prism-text-secondary);">FFT analysis with frequency bands output</div>
          </div>
        </div>

        <div onclick="addNode('Color Mapper')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="palette" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-color);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Color Mapper</span>
              <span style="padding: 2px 6px; background-color: rgba(34, 221, 136, 0.2); color: var(--prism-success); font-size: 9px; font-weight: 600; border-radius: 4px;">LOW</span>
            </div>
            <div style="font-size: 11px; color: var(--prism-text-secondary);">Maps values to color gradients</div>
          </div>
        </div>

        <div onclick="addNode('LED Output')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="monitor" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-output);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">LED Output</span>
              <span style="padding: 2px 6px; background-color: rgba(34, 221, 136, 0.2); color: var(--prism-success); font-size: 9px; font-weight: 600; border-radius: 4px;">LOW</span>
            </div>
            <div style="font-size: 11px; color: var(--prism-text-secondary);">Sends color data to LED strip</div>
          </div>
        </div>

        <div onclick="addNode('Blur Filter')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; margin-bottom: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="blur" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-info);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Blur Filter</span>
              <span style="padding: 2px 6px; background-color: rgba(239, 68, 68, 0.2); color: var(--prism-error); font-size: 9px; font-weight: 600; border-radius: 4px;">HIGH</span>
            </div>
            <div style="font-size: 11px; color: var(--prism-text-secondary);">Applies Gaussian blur to field data</div>
          </div>
        </div>

        <div onclick="addNode('Math Operation')" style="padding: 12px; background-color: var(--prism-bg-elevated); border: 1px solid rgba(181, 189, 202, 0.1); border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: all 120ms ease-out;">
          <div style="width: 40px; height: 40px; background-color: var(--prism-bg-surface); border-radius: 8px; display: flex; align-items: center; justify-content: center;">
            <i data-lucide="calculator" style="width: 20px; height: 20px; stroke-width: 1.5; color: var(--prism-scalar);"></i>
          </div>
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
              <span style="font-size: 14px; font-weight: 600; color: var(--prism-text-primary);">Math Operation</span>
              <span style="padding: 2px 6px; background-color: rgba(34, 221, 136, 0.2); color: var(--prism-success); font-size: 9px; font-weight: 600; border-radius: 4px;">LOW</span>
            </div>
            </div></div></div></div></div></body></html>